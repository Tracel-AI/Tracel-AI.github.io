<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Trait to be implemented for training models."><title>TrainStep in burn::train - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-fa3bb1812debf86c.css"><script id="default-settings" 
data-theme="burn"
data-use_system_theme="false"></script><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="burn" data-themes="burn" data-resource-suffix="" data-rustdoc-version="1.74.0 (79e9716c9 2023-11-13)" data-channel="1.74.0" data-search-js="search-8be46b629f5f14a8.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-c5bd66d33317d69f.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../burn/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a></nav><nav class="sidebar"><a class="logo-container" href="../../burn/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">TrainStep</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.step">step</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.optimize">optimize</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In burn::train</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">burn</a>::<wbr><a href="index.html">train</a>::<wbr><a class="trait" href="#">TrainStep</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/burn_train/learner/train_val.rs.html#54">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait TrainStep&lt;TI, TO&gt; {
    // Required method
    fn <a href="#tymethod.step" class="fn">step</a>(&amp;self, item: TI) -&gt; <a class="struct" href="struct.TrainOutput.html" title="struct burn::train::TrainOutput">TrainOutput</a>&lt;TO&gt;;

    // Provided method
    fn <a href="#method.optimize" class="fn">optimize</a>&lt;B, O&gt;(
        self,
        optim: <a class="primitive" href="https://doc.rust-lang.org/1.74.0/std/primitive.reference.html">&amp;mut O</a>,
        lr: <a class="primitive" href="https://doc.rust-lang.org/1.74.0/std/primitive.f64.html">f64</a>,
        grads: <a class="struct" href="../optim/struct.GradientsParams.html" title="struct burn::optim::GradientsParams">GradientsParams</a>
    ) -&gt; Self
       <span class="where">where B: <a class="trait" href="../tensor/backend/trait.AutodiffBackend.html" title="trait burn::tensor::backend::AutodiffBackend">AutodiffBackend</a>,
             O: <a class="trait" href="../optim/trait.Optimizer.html" title="trait burn::optim::Optimizer">Optimizer</a>&lt;Self, B&gt;,
             Self: <a class="trait" href="../module/trait.AutodiffModule.html" title="trait burn::module::AutodiffModule">AutodiffModule</a>&lt;B&gt;</span> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Trait to be implemented for training models.</p>
<p>The <a href="trait.TrainStep.html#tymethod.step" title="method burn::train::TrainStep::step">step</a> method needs to be manually implemented for all structs.</p>
<p>The <a href="trait.TrainStep.html#method.optimize" title="method burn::train::TrainStep::optimize">optimize</a> method can be overridden if you want to control how the
optimizer is used to update the model. This can be useful if you want to call custom mutable
functions on your model (e.g., clipping the weights) before or after the optimizer is used.</p>
<h2 id="notes"><a href="#notes">Notes</a></h2>
<p>To be used with the <a href="struct.Learner.html" title="struct burn::train::Learner">Learner</a> struct, the struct which implements this trait must
also implement the <a href="../module/trait.AutodiffModule.html" title="trait burn::module::AutodiffModule">AutodiffModule</a> trait, which is done automatically with the
<a href="../module/trait.Module.html" title="trait burn::module::Module">Module</a> derive.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.step" class="method"><a class="src rightside" href="../../src/burn_train/learner/train_val.rs.html#64">source</a><h4 class="code-header">fn <a href="#tymethod.step" class="fn">step</a>(&amp;self, item: TI) -&gt; <a class="struct" href="struct.TrainOutput.html" title="struct burn::train::TrainOutput">TrainOutput</a>&lt;TO&gt;</h4></section></summary><div class="docblock"><p>Runs the training step, which executes the forward and backward passes.</p>
<h5 id="arguments"><a href="#arguments">Arguments</a></h5>
<ul>
<li><code>item</code> - The training input for the model.</li>
</ul>
<h5 id="returns"><a href="#returns">Returns</a></h5>
<p>The training output containing the model output and the gradients.</p>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.optimize" class="method"><a class="src rightside" href="../../src/burn_train/learner/train_val.rs.html#76-80">source</a><h4 class="code-header">fn <a href="#method.optimize" class="fn">optimize</a>&lt;B, O&gt;(self, optim: <a class="primitive" href="https://doc.rust-lang.org/1.74.0/std/primitive.reference.html">&amp;mut O</a>, lr: <a class="primitive" href="https://doc.rust-lang.org/1.74.0/std/primitive.f64.html">f64</a>, grads: <a class="struct" href="../optim/struct.GradientsParams.html" title="struct burn::optim::GradientsParams">GradientsParams</a>) -&gt; Self<span class="where fmt-newline">where
    B: <a class="trait" href="../tensor/backend/trait.AutodiffBackend.html" title="trait burn::tensor::backend::AutodiffBackend">AutodiffBackend</a>,
    O: <a class="trait" href="../optim/trait.Optimizer.html" title="trait burn::optim::Optimizer">Optimizer</a>&lt;Self, B&gt;,
    Self: <a class="trait" href="../module/trait.AutodiffModule.html" title="trait burn::module::AutodiffModule">AutodiffModule</a>&lt;B&gt;,</span></h4></section></summary><div class="docblock"><p>Optimize the current module with the provided gradients and learning rate.</p>
<h5 id="arguments-1"><a href="#arguments-1">Arguments</a></h5>
<ul>
<li><code>optim</code>: Optimizer used for training this model.</li>
<li><code>lr</code>: The learning rate used for this step.</li>
<li><code>grads</code>: The gradients of each parameter in the current model.</li>
</ul>
<h5 id="returns-1"><a href="#returns-1">Returns</a></h5>
<p>The updated model.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../../implementors/burn_train/learner/train_val/trait.TrainStep.js" async></script></section></div></main></body></html>